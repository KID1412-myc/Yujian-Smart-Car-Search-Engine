# 驭·见 智能车辆搜索引擎

这是一个全栈智能车辆搜索引擎项目，集成了 Elasticsearch、RAG (AI 问答)、MySQL 用户系统和 Playwright 爬虫。



## 核心功能

* **混合搜索**：同时支持传统关键字/分面搜索 和 AI 智能推荐。
* **AI 智能 (RAG)**：基于 DeepSeek API，能理解自然语言意图，并结合 ES 召回的“参数库”和“口碑库”生成推荐。
* **完整用户系统**：基于 Flask、SQLAlchemy (MySQL) 和 JWT Cookies，实现注册、登录 和个人资料修改。
* **核心用户功能**：实现“我的收藏” 和“车型对比”。
* **强大管理后台**：带权限分级（`admin` / `core_admin`）的管理后台，支持用户管理、ES 数据在线编辑 和高危操作密码验证。
* **自动化数据管道**：支持从后台远程触发 Playwright 爬虫 和数据导入任务。

## 技术栈

* **前端**: HTML5, TailwindCSS, Vanilla JavaScript
* **后端**: Flask, SQLAlchemy (MySQL) ,Python 3.13.2
* **搜索引擎**: Elasticsearch 8.11.3
* **AI (RAG)**: DeepSeek API 
* **认证**: Flask-JWT-Extended (Cookies)
* **数据采集**: Playwright (Async), BeautifulSoup4
* **数据库迁移**: Flask-Migrate

## 如何运行

1.  **准备环境**:
    * 确保已安装 Python, MySQL 和 Elasticsearch。
    * 克隆本项目：`git clone ...`
    * 创建并激活虚拟环境：`python -m venv .venv`
    * 安装依赖：`pip install -r requirements.txt`

2.  **配置密钥**:
    * **新建 `.env` 文件**（本项目已使用 `.env` 管理密钥）。
    * 在 `.env` 中填入您的 `DEEPSEEK_API_KEY`、`DATABASE_URL` (MySQL连接字符串) 和 `JWT_SECRET_KEY`。

3.  **初始化数据库**：
    ***注意：因为主程序文件名为 `app_ds2.py`，所以所有 `flask` 命令都需要指定 `--app` 参数。***
    * (您需要先安装 `flask-migrate`: `pip install flask-migrate`)
    * **首次初始化**: `flask --app app_ds2.py db init`
    * **生成迁移文件**: `flask --app app_ds2.py db migrate -m "Initial migration"`
    * **应用数据库结构**: `flask --app app_ds2.py db upgrade` (应用数据库结构，包括 `users`, `favorites`, `system_config` 等表的创建)
4.  **导入数据**:
    * **本地运行方案如下：**
    * 直接在本地运行爬虫 `一体化爬虫.py ` 来生成 `*.csv` 数据。**注意：最好不要一次性爬取过多车系数据，避免导入ES超时而失败**
    * 先运行导入脚本 `import_data2.0可清除索引.py` 将保存在项目根目录的第一个csv文件导入 ES。
    * 随后运行另一个导入脚本`import_data2.0不清除索引.py`来一键导入剩余所有数据，将存放在指定目录下的全部csv文件导入ES，推荐在项目根目录新建一个文件夹，在里面存放除了已经导入完成的那个文件外的其余数据文件，避免重复导入。
    * **注意，您同样可以在前端操作页面进行数据采集与导入，但推荐已经通过本地操作导入绝大多数数据后来使用此功能，因为前端只能逐个数据导入，无法一次性上传。前端导入适用于补充数据。**

5.  **启动后端**:
    * `python app_ds2.py`

6.  **启动前端**:
    * 前端文件 (如 `车系.html`) 依赖 `config.js` 自动检测 IP。请使用本地 Web 服务器（如 VS Code 的 Live Server 插件或 `python -m http.server 8000`）来访问 `车系.html`，**不要**直接在浏览器中双击文件打开。

7.  **核心管理员（core_admin）设置说明**:
    * 因核心管理员身份拥有后台操作的最高权限，为保证系统数据安全，核心管理员身份不支持前端修改，您可通过直接在数据库的user表中操作设置您的第一个核心管理员。
## ⚖️ 免责声明 (Disclaimer)

本项目 **驭·见 智能车辆搜索引擎** 仅作为个人技术项目或学术研究进行开发和展示，其目的在于学习、研究和交流相关技术，包括但不限于：Elasticsearch 搜索技术、RAG 问答架构、网络爬虫和用户认证系统。

**请您严格注意以下几点：**

1.  **数据来源与版权**：本项目中展示的所有车辆参数、配置及用户口碑数据，均采集自 **易车 (Yiche.com)**。
    * **本项目不对数据的准确性、完整性或时效性提供任何保证**。
    * **所有数据的版权归原始数据提供方所有。**
2.  **非商业用途**：本项目**严禁用于任何形式的商业目的**。如果您需要使用这些数据或技术进行商业活动，请务必获取原始数据提供方的官方授权。
3.  **用户责任**：本项目的用户或查看者在使用本项目代码或数据进行任何活动（包括重新爬取、二次开发或发布）时，**必须自行承担所有法律责任和风险**。
4.  **AI 服务**：本项目的 AI 问答功能依赖第三方大语言模型 (LLM) 服务，其回答可能存在局限性、幻觉或偏差。**AI 的任何输出不构成最终的购车建议。**

**本项目开发者不承担因使用、分发或修改本项目代码和数据所引起的任何法律责任。**